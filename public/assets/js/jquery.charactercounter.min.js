!function (e) {
    e.fn.characterCounter = function (t) {

        function n(t) {
            var n = e(t).val().length;
            c.countNewLineChars && (n += e(t).val().split(/\r*\n/).length);
            var r = c.counterSelector ? e(c.counterSelector) : e(t).nextAll("." + c.counterCssClass).first(),
                s = c.limit - n, o = s < c.exl;
            c.increaseCounting && (o = (s = n) > c.limit),
                o ? (r.addClass(c.counterExceededCssClass),
                    c.exceeded = !0,
                    c.onExceed(n)) : c.exceeded && (r.removeClass(c.counterExceededCssClass),
                    c.onDeceed(n),
                    c.exceeded = !1
                ),
                r.html(
                function (e) {
                    var t = c.counterFormat.replace(/%1/, e);
                    return c.renderTotal && (t += " / " + c.limit), t
                }(s))
        }

        var r = {
                exceeded: !1,
                counterSelector: !1,
                countNewLineChars: !1,
                limit: 150,
                renderTotal: !0,
                counterWrapper: "span",
                counterCssClass: "textarea-counter",
                counterFormat: "%1",
                counterExceededCssClass: "exceeded",
                increaseCounting: !1,
                exl: 51,
                onExceed: function (e) {
                },
                onDeceed: function (e) {
                },
                customFields: {}
            },
            c = e.extend(r, t);
        return this.each(function () {
            var t = e(this).attr("maxlength", r.limit);
            void 0 !== t && !1 !== t && e.extend(r,
                {
                    limit: parseInt(e(this).attr("maxlength"))
                }),
            c.counterSelector || e(this).after(
                function () {
                    var e = c.counterCssClass;
                    return c.customFields.class && (e += " " + c.customFields.class,
                        delete c.customFields.class),
                    "<" + c.counterWrapper + function (e) {
                        var t,
                            n = "";
                        for (t in e) n += " " + t + '="' + e[t] + '"';
                        return n
                    }
                    (c.customFields) + ' class="' + e + '"></' + c.counterWrapper + ">"
                }()),
                function (t) {
                    e(t).on("input change", function () {
                        n(t)
                    })
                }(this), n(this)
        })
    }
}(jQuery);